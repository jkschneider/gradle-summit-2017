{"paragraphs":[{"text":"%dep\nz.addRepo(\"jcenter\").url(\"https://jcenter.bintray.com\")\nz.load(\"com.spotify:spark-bigquery_2.11:0.2.0\")\nz.load(\"com.netflix.devinsight.rewrite:rewrite-core:jar:jdkbundle:1.2.4\")\nz.load(\"org.scalaj:scalaj-http_2.11:2.3.0\")","dateUpdated":"2017-06-17T03:03:12+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","tableHide":true,"graph":{"mode":"table","height":90,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1497651747692_-1229204446","id":"20170615-173110_1105341905","result":{"code":"SUCCESS","type":"TEXT","msg":"DepInterpreter(%dep) deprecated. Add repository through GUI interpreter menu instead.\nDepInterpreter(%dep) deprecated. Load dependency through GUI interpreter menu instead.\nDepInterpreter(%dep) deprecated. Load dependency through GUI interpreter menu instead.\nDepInterpreter(%dep) deprecated. Load dependency through GUI interpreter menu instead.\nres0: org.apache.zeppelin.dep.Dependency = org.apache.zeppelin.dep.Dependency@5a66b10e\n"},"dateCreated":"2017-06-16T22:22:27+0000","dateStarted":"2017-06-17T03:03:12+0000","dateFinished":"2017-06-17T03:03:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16891"},{"title":"Imports","text":"import collection.JavaConverters._\nimport com.netflix.rewrite.parse.OracleJdkParser\nimport com.netflix.rewrite.ast._\nimport java.nio.file.Paths\nimport scalaj.http.Http\nimport scala.util.Try","dateUpdated":"2017-06-17T04:12:38+0000","config":{"tableHide":true,"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1497651747693_-1229589195","id":"20170615-215645_602848641","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport com.netflix.rewrite.parse._\n\nimport com.netflix.rewrite.ast._\n\nimport com.netflix.rewrite.ast.visitor.AstVisitor\n\nimport collection.JavaConverters._\n\nimport java.nio.file._\n\nimport scalaj.http.Http\n\nimport scala.util.Try\n\ndefined class JavaSource\n"},"dateCreated":"2017-06-16T22:22:27+0000","dateStarted":"2017-06-17T03:03:13+0000","dateFinished":"2017-06-17T03:03:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16892"},{"title":"This is the Guava jar we will use in AST parsing","text":"sc.addFile(\"http://repo1.maven.org/maven2/com/google/guava/guava/18.0/guava-18.0.jar\")","dateUpdated":"2017-06-17T03:03:12+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1497651747694_-1228434948","id":"20170615-214744_1824207992","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2017-06-16T22:22:27+0000","dateStarted":"2017-06-17T03:03:20+0000","dateFinished":"2017-06-17T03:03:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16893"},{"title":"Pull all the Java sources out of BigQuery","text":"import com.spotify.spark.bigquery._\n\nval sources = sqlContext.bigQuerySelect(\"SELECT * FROM [cf-sandbox-jschneider:gradle_summit.java_file_contents_guava]\")\n    .rdd\n    .repartition(2000)","dateUpdated":"2017-06-17T04:11:49+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1497651747694_-1228434948","id":"20170615-171334_393033523","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport com.spotify.spark.bigquery._\n\nsources: org.apache.spark.rdd.RDD[JavaSource] = MapPartitionsRDD[8] at map at <console>:49\n"},"dateCreated":"2017-06-16T22:22:27+0000","dateStarted":"2017-06-17T03:03:41+0000","dateFinished":"2017-06-17T03:05:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16894"},{"title":"Parse Java sources into ASTs with Rewrite","text":"val parsed = sources.flatMap(row => {\n    val parser = new OracleJdkParser(List(Paths.get(org.apache.spark.SparkFiles.get(\"guava-18.0.jar\"))).asJava)\n    try {\n      val start = System.nanoTime()\n      val parsed = Some(parser.parse(row.getAs(\"content\"))) // turn the source into a Rewrite AST\n      Try(Http(s\"http://cluster-1-m:8101/api/timer/parse/${System.nanoTime()-start}\").postData(\"\").execute()) // metrics!\n      (row.getAs(\"repo_name\"), row.getAs(\"path\"), parsed)\n    } catch {\n        case _: Throwable => None // some Java sources will be so badly formed that they are bound to trip up the parser\n    }\n})\nparsed.cache","dateUpdated":"2017-06-17T04:11:49+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1497651747694_-1228434948","id":"20170615-221626_202043697","result":{"code":"SUCCESS","type":"TEXT","msg":"\n\nwarning: While parsing annotations in /usr/lib/zeppelin/local-repo/com/netflix/devinsight/rewrite/rewrite-core/1.2.4/rewrite-core-1.2.4-jdkbundle.jar(com/netflix/rewrite/ast/Tree.class), could not find PROPERTY in enum <none>.\nThis is likely due to an implementation restriction: an annotation argument cannot refer to a member of the annotated class (SI-7014).\n\nparsed: org.apache.spark.rdd.RDD[com.netflix.rewrite.ast.Tr$CompilationUnit] = MapPartitionsRDD[13] at flatMap at <console>:49\n\nres6: parsed.type = MapPartitionsRDD[13] at flatMap at <console>:49\n"},"dateCreated":"2017-06-16T22:22:27+0000","dateStarted":"2017-06-17T03:03:42+0000","dateFinished":"2017-06-17T03:05:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16895"},{"title":"How many sources did we successfully parse?","text":"parsed.count","dateUpdated":"2017-06-17T03:55:51+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1497651747694_-1228434948","id":"20170616-012252_1288931189","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres8: Long = 2590078\n"},"dateCreated":"2017-06-16T22:22:27+0000","dateStarted":"2017-06-17T03:05:12+0000","dateFinished":"2017-06-17T03:43:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16896"},{"text":"","dateUpdated":"2017-06-17T03:03:12+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1497651747696_-1218431477","id":"20170616-052725_1316908264","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2017-06-16T22:22:27+0000","dateStarted":"2017-06-17T03:43:07+0000","dateFinished":"2017-06-17T03:43:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16897"}],"name":"Guava","id":"2CN1K5R8C","angularObjects":{"2CKVFSE29:shared_process":[],"2CKGNSN5K:shared_process":[],"2CKB1Z2DA:shared_process":[],"2CKQ3TWXX:shared_process":[],"2CNGHCSYY:shared_process":[],"2CKPFKKWA:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}